-----------------------------------------------------描述: 将星网络消息处理及其逻辑--时间: 2012.6.6--作者: qbw---------------------------------------------------MsgHeroStar = {}p = MsgHeroStar;local	MSG_GS_ACTION_LIGHTAMOUNT        	 = 1;		--接收星点信息local	MSG_GS_ACTION_LIGHTPOINT_SUC         = 3;		--点亮星点动作成功local	MSG_GS_ACTION_LIGHTPOINT_FAIL        = 4;		--点亮星点动作失败local	MSG_GS_ACTION_LIGHTPOINT       		 = 2;		--点亮星点动作--点亮星点function p.SendHeroStarActionLight(nGrade,nLev)	if not CheckN(nGrade) or not CheckN(nLev) then		return false;	end	local netdata = createNDTransData(NMSG_Type._MSG_ADVANCED_GS);	if nil == netdata then		return false;	end			netdata:WriteByte(MSG_GS_ACTION_LIGHTPOINT);	netdata:WriteByte(nGrade);	netdata:WriteByte(nLev);		SendMsg(netdata);	netdata:Free();	LogInfo("send  light herostar nGrade:["..nGrade.."] nlev:["..nLev.."]");	ShowLoadBar();	return true;endfunction p.SendHeroStarActionUpdate()	local netdata = createNDTransData(NMSG_Type._MSG_ADVANCED_GS);	if nil == netdata then		return false;	end			netdata:WriteByte(MSG_GS_ACTION_LIGHTAMOUNT);	--netdata:WriteByte(nGrade);	--netdata:WriteByte(nLev);		SendMsg(netdata);	netdata:Free();	LogInfo("send  request herostar amount");	return true;end--将星数据更新function p.ProcessHeroStarInfoUpdate(netdata)	local nAction      = netdata:ReadByte();	local idUser = GetPlayerId();	if nAction == MSG_GS_ACTION_LIGHTAMOUNT then		--接收星点数据		CloseLoadBar();			local nCount = netdata:ReadByte();				LogInfo("update  herostar amount :"..nCount)		for i=1,nCount do			local nGrade = netdata:ReadByte();			local nLev	=  netdata:ReadByte();						HeroStar.SetRoleHeroStarData(idUser,nGrade,nLev)									if  IsUIShow(NMAINSCENECHILDTAG.HeroStarUI) then				--HeroStarUI.RefreshStarVC();				HeroStarUI.StarDataRefreshCallback()			end			--LogInfo("update  herostar"..nGrade.." point:"..nLev);					end				HeroStar.HeroInfoUpdate();			elseif 	nAction == MSG_GS_ACTION_LIGHTPOINT_SUC then		LogInfo("light  herostar succ");				if  IsUIShow(NMAINSCENECHILDTAG.HeroStarUI) then						HeroStarUI.LightSuccCallback();		end				--引导任务事件触发		GlobalEvent.OnEvent(GLOBALEVENT.GE_GUIDETASK_ACTION,TASK_GUIDE_PARAM.GS);			elseif 	nAction == MSG_GS_ACTION_LIGHTPOINT_FAIL then		CloseLoadBar();		LogInfo("light  herostar fail");		endendRegisterNetMsgHandler(NMSG_Type._MSG_ADVANCED_GS, "p.ProcessHeroStarInfoUpdate", p.ProcessHeroStarInfoUpdate);